SELECT CUSTOMER.C_CUSTKEY, SUM(LINEITEM.L_EXTENDEDPRICE * (1 + LINEITEM.L_DISCOUNT)) AS REVENUE, CUSTOMER.C_ACCTBAL 
FROM CUSTOMER, ORDERS, LINEITEM, NATION 
WHERE CUSTOMER.C_CUSTKEY = ORDERS.O_CUSTKEY 
AND (LINEITEM.L_DISCOUNT < .06 OR LINEITEM.L_QUANTITY < 24) 
AND LINEITEM.L_ORDERKEY = ORDERS.O_ORDERKEY 
AND LINEITEM.L_RETURNFLAG = 'R' 
AND CUSTOMER.C_NATIONKEY = NATION.N_NATIONKEY 
GROUP BY CUSTOMER.C_CUSTKEY, CUSTOMER.C_ACCTBAL 
ORDER BY REVENUE ASC LIMIT 20;

SELECT SUM(L_EXTENDEDPRICE*L_DISCOUNT) AS REVENUE 
FROM LINEITEM 
WHERE L_DISCOUNT > 0.04 
AND L_DISCOUNT < 0.08;

SELECT LINEITEM.L_ORDERKEY, SUM(LINEITEM.L_EXTENDEDPRICE*(1-LINEITEM.L_DISCOUNT)) AS REVENUE, ORDERS.O_ORDERDATE, ORDERS.O_SHIPPRIORITY 
FROM CUSTOMER, ORDERS, LINEITEM 
WHERE CUSTOMER.C_MKTSEGMENT = 'BUILDING' 
AND CUSTOMER.C_CUSTKEY = ORDERS.O_CUSTKEY 
AND LINEITEM.L_ORDERKEY = ORDERS.O_ORDERKEY 
AND (LINEITEM.L_DISCOUNT < .06 OR LINEITEM.L_QUANTITY < 24) 
GROUP BY ORDERS.O_ORDERDATE, ORDERS.O_SHIPPRIORITY, LINEITEM.L_ORDERKEY 
ORDER BY REVENUE DESC, ORDERS.O_ORDERDATE;

SELECT L_LINESTATUS, O_ORDERKEY, SUM(L_QUANTITY) AS SUM_QTY, SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)) AS SUM_DISC_PRICE, SUM(L_EXTENDEDPRICE*(1-L_DISCOUNT)*(1+L_TAX)) AS SUM_CHARGE, AVG(L_QUANTITY) AS AVG_QTY, AVG(L_EXTENDEDPRICE) AS AVG_PRICE, AVG(L_DISCOUNT) AS AVG_DISC 
FROM LINEITEM,ORDERS 
GROUP BY L_LINESTATUS, O_ORDERKEY 
ORDER BY L_LINESTATUS;

SELECT SUM(SUB_Q.P1_WEIGHT*1.0) 
FROM (SELECT P1.FIRSTNAME AS P1_FIRSTNAME, 
			P1.LASTNAME AS P1_LASTNAME, 
			P2.FIRSTNAME AS P2_FIRSTNAME, 
			P2.LASTNAME AS P2_LASTNAME, 
			P1.FIRSTSEASON AS P1_FIRSTSEASON, 
			P1.LASTSEASON AS P1_LASTSEASON, 
			P2.FIRSTSEASON AS P2_FIRSTSEASON, 
			P2.LASTSEASON AS P2_LASTSEASON, 
			P1.WEIGHT AS P1_WEIGHT 
		FROM PLAYERS P1, PLAYERS P2 WHERE P1.ID = P2.ID AND P1.FIRSTSEASON < 2007) SUB_Q;
		
		